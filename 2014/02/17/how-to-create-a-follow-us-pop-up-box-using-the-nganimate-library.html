<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><title>How to create a "Follow Us" pop-up box using the ngAnimate library - Ragnarson Blog</title><meta content="summary" name="twitter:card" /><meta content="@ragnarsoncom" name="twitter:site" /><meta content="Ragnarson Blog" property="og:site_name" /><meta content="article" property="og:type" /><meta content="https://blog.ragnarson.com/2014/02/17/how-to-create-a-follow-us-pop-up-box-using-the-nganimate-library.html" property="og:url" /><meta content="How to create a "Follow Us" pop-up box using the ngAnimate library" property="og:title" /><meta content="The following article has been prepared based on AngularJS and ngAnimate
version 1.2.12, so the provided code examples may not work properly
with older or newer versions of these libraries." property="og:description" /><meta content="Bartłomiej Kozal" name="author" /><meta content="https://blog.ragnarson.com/images/blog-embed-c040007b71.png" property="og:image" /><meta content="@_bkzl" name="twitter:creator" /><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css" /><link href="https://fonts.googleapis.com/css?family=Lato:400,700&subset=latin,latin-ext" rel="stylesheet" type="text/css" /><script type="application/ld+json">{"@context":"http://schema.org","@type":"Organization","name":"Ragnarson","url":"https://ragnarson.com"}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","name":"Ragnarson Blog","url":"https://blog.ragnarson.com"}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Person","name":"Bartłomiej Kozal","image":"https://www.gravatar.com/avatar/11ec30dedeb7889af512461ba7ce6a45.jpg?s=144&d=mm"}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","headline":"How to create a \"Follow Us\" pop-up box using the ngAnimate library","url":"https://blog.ragnarson.com/2014/02/17/how-to-create-a-follow-us-pop-up-box-using-the-nganimate-library.html","author":{"@type":"Person","name":"Bartłomiej Kozal","image":"https://www.gravatar.com/avatar/11ec30dedeb7889af512461ba7ce6a45.jpg?s=144&d=mm"},"publisher":{"@type":"Organization","name":"Ragnarson","url":"https://ragnarson.com","logo":"https://blog.ragnarson.com/images/brand-c0054f1cec.svg"},"datePublished":"2014-02-17","dateModified":"2014-02-17"}</script><meta content="width=device-width, initial-scale=1.0" name="viewport" /><link href="/stylesheets/application-c0f3339569.css" rel="stylesheet" /><link href="/favicon-152-c0fe5a334d.png" rel="apple-touch-icon-precomposed" /><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-11839548-2');
ga('set', 'allowAdFeatures', false);
ga('set', 'anonymizeIp', true);
ga('send', 'pageview');
</script>
</head><body><div class="container nav-container"><nav class="navbar navbar-dark navbar-toggleable-md"><button aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler navbar-toggler-right" data-target="#navbarResponsive" data-toggle="collapse" type="button"><i class="icon-menu"></i></button><a href="https://ragnarson.com" class="nav-brand navbar-logo"><img src="/images/brand-c0054f1cec.svg" title="Ragnarson Blog" width="220px" alt="Brand" /></a><div class="collapse navbar-collapse" id="navbarResponsive"><ul class="nav navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Why us</a><div class="dropdown-menu"><a href="https://ragnarson.com/our-story/" class="dropdown-item">Our story</a><a href="https://ragnarson.com/core-values/" class="dropdown-item">Core Values</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Services</a><div class="dropdown-menu"><a href="https://ragnarson.com/services/web-app-development/" class="dropdown-item">Web app development</a><a href="https://ragnarson.com/services/infrastructure-and-devops/" class="dropdown-item">Infrastructure and DevOps</a></div></li><li class="nav-item"><a href="https://ragnarson.com/case-studies/" class="nav-link">Case studies</a></li><li class="nav-item"><a href="https://ragnarson.com/community/" class="nav-link">Community</a></li><li class="nav-item"><a href="https://ragnarson.com/?utm_source=ragnarson&amp;utm_medium=blog&amp;utm_campaign=blog-header#contact" class="nav-link">Contact</a></li><li class="nav-item"><a href="/" class="active nav-link">Blog</a></li><li class="nav-item"><a href="http://jobs.ragnarson.com" class="nav-link">Jobs</a></li></ul></div></nav></div><div class="newsletter-show newsletter-container" id="js-box"><div class="newsletter-toggler"><i class="icon-chevron-right" id="js-arrow"></i></div><div class="newsletter-box"><div class="newsletter-popup"><div id="mc_embed_signup">
  <form action="//ragnarson.us10.list-manage.com/subscribe/post?u=6a4a4d00f989604300f83d3de&amp;id=6adadf2f44" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
      <label for="mce-EMAIL" class="newsletter-label">
        Sign up for our newsletter and get notifications about new articles on your email
      </label>

      <div class="row">
        <div class="three-thirds">
          <input type="email" value="" name="EMAIL" class="newsletter-input" id="mce-EMAIL" placeholder="Your email address" required>

          <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
          <div class="signup_hidden">
            <input type="text" name="b_6a4a4d00f989604300f83d3de_6adadf2f44" tabindex="-1" value="" class="one-half">
          </div>
        </div>

        <div class="mt-3 text-center">
          <input type="submit" value="Join our newsletter" name="subscribe" id="mc-embedded-subscribe" class="btn newsletter-btn">
        </div>
      </div>
    </div>
  </form>
</div>
</div></div></div><div id="main" role="main"><div class="article"><header><img src="https://www.gravatar.com/avatar/11ec30dedeb7889af512461ba7ce6a45.jpg?s=144&amp;d=mm" class="avatar" width="72px" size="72px" alt="11ec30dedeb7889af512461ba7ce6a45" /><div class="article-meta">February 17, 2014 - <a href="/authors/bartlomiej-kozal.html">Bartłomiej Kozal</a>  in <a href="/categories/development.html">development</a></div><h1 class="article-title"><a href="/2014/02/17/how-to-create-a-follow-us-pop-up-box-using-the-nganimate-library.html">How to create a "Follow Us" pop-up box using the ngAnimate library</a></h1></header><div class="article-notice">This article was originally posted on the Shelly Cloud blog, our Ruby
platform as a service that we have decided to shut down on October 2015.</div><p><em>The following article has been prepared based on AngularJS and ngAnimate
version 1.2.12, so the provided code examples may not work properly
with older or newer versions of these libraries.</em> </p>
<figure>
<p><img src="/2014/02/17/how-to-create-a-follow-us-pop-up-box-using-the-nganimate-library/animation-c02df83682.gif" alt="Follow Us pop-up" /></p>
</figure>
<h2>What is ngAnimate?</h2>

<p>ngAnimate is an efficient, well-tested and easy to use library that
simplifies adding and managing animations in all applications based on the
AngularJS framework. The extension uses native technologies,
such as CSS Transitions, CSS Animations and JS Animations, which are supported
by all modern web browsers. Therefore, using it is very simple, and there are
no major problems with implementing it in existing web applications.</p>

<p>There are many practical benefits of using this library. For example, it solves
the notorious problem with different animations writing over themselves when
used with the same element. It also allows for enabling or disabling
a particular animation, depending on the effect we wish to achieve.</p>

<p>It is worth noting that the existing directives are aware of ngAnimate&#39;s
existence, so using it requires no additional configuration and works immediately
after its installation.</p>

<h2>Installation</h2>

<p>We add ngAnimate to an application via a standard HTML import:</p>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"//ajax.googleapis.com/ajax/libs/angularjs/1.2.12/angular.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"//ajax.googleapis.com/ajax/libs/angularjs/1.2.12/angular-animate.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>

<p>And load our module as application&#39;s dependency:</p>
<pre class="highlight javascript"><code><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'ngAnimate'</span><span class="p">]);</span>
</code></pre>

<h2>How it works</h2>

<p>As I mentioned, Angular&#39;s existing directives assume the existence of ngAnimate
and use the <code>$animate</code> service in their implementations. The <code>$animate</code> service
ensures the addition of appropriate CSS classes, depending on the event that
may occur for a given directive. This can be shown with a table:</p>
<table class="table--striped">
<p><thead>
<tr>
  <th>Directive</th>
  <th>Events</th>
</tr>
</thead>
<tbody>
<tr>
  <td>ngRepeat</td>
  <td>enter, move, leave</td>
</tr>
<tr>
  <td>ngView</td>
  <td>enter, leave</td>
</tr>
<tr>
  <td>ngSwitch, ngInclude, ngIf</td>
  <td>enter, leave</td>
</tr>
<tr>
  <td>ngClass</td>
  <td>addClass, removeClass</td>
</tr>
<tr>
  <td>ngHide, ngShow</td>
  <td>addClass(&#39;.ng-hide&#39;), removeClass(&#39;.ng-hide&#39;)</td>
</tr>
</tbody></p>
</table>
<h2>How to use</h2>

<h3>CSS Transitions</h3>

<p>There are three methods of attaching an animation to a chosen element.
The simplest one is by using CSS Transitions.</p>

<p>Let&#39;s say that we have the following element that uses the directive <code>ng-show</code>,
and that we want the text to change color from blue to red upon calling
that directive:</p>
<pre class="highlight html"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">""</span> <span class="na">ng-click=</span><span class="s">"showHeader = true"</span><span class="nt">&gt;</span>Show header<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"effect"</span> <span class="na">ng-show=</span><span class="s">"showHeader"</span><span class="nt">&gt;</span>Foo<span class="nt">&lt;/h1&gt;</span>
</code></pre>

<p>The corresponding CSS will look as follows:</p>
<pre class="highlight css"><code><span class="nc">.effect</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
  <span class="nl">transition</span><span class="p">:</span> <span class="n">color</span> <span class="m">.5s</span> <span class="n">linear</span><span class="p">;</span>
  <span class="nl">-webkit-transition</span><span class="p">:</span> <span class="n">color</span> <span class="m">.5s</span> <span class="n">linear</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.effect.ng-hide-remove</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p>Where did <code>.ng-hide-remove</code> come from? Depending on the event, ngAnimate
adds two classes to the element for controlling the animation. The first one
is set at the start of the animation, and the second one at the end. In the case
of <code>ng-show</code>, these are respectively <code>.ng-hide-remove</code> and <code>.ng-hide-remove-active</code>.</p>

<p>A detailed explanation of all possible events and their corresponding classes
can be found <a href="http://www.yearofmoo.com/2013/08/remastered-animation-in-angularjs-1-2.html">in a post on the blog of one of ngAnimate&#39;s authors</a>.</p>

<h3>CSS Animations</h3>

<p>Another method is to use CSS Animations. It has an advantage over Transitions
in that we are given the ability to define more than two animation steps,
which lets us create effects that are more complex.</p>

<p>For the same directive as in the previous example, the CSS animation code
to create a transition from red to green to blue will look as follows:</p>
<pre class="highlight css"><code><span class="nc">.effect</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
  <span class="nl">animation</span><span class="p">:</span> <span class="m">.5s</span> <span class="n">rainbow</span><span class="p">;</span>
  <span class="nl">-webkit-animation</span><span class="p">:</span> <span class="m">.5s</span> <span class="n">rainbow</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@keyframes</span> <span class="n">rainbow</span> <span class="p">{</span>
  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span> <span class="p">}</span>
  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span> <span class="p">}</span>
  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">@-webkit-keyframes</span> <span class="n">rainbow</span> <span class="p">{</span>
  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span> <span class="p">}</span>
  <span class="nt">50</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span> <span class="p">}</span>
  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>This time, we don&#39;t have to add any special classes to the styles, because
the animation&#39;s start and end are clearly defined in the animation&#39;s definition.</p>

<h3>JS Animations</h3>

<p>The last method is to define the animation directly in JavaScript. We do this
via the <code>animation</code> function provided by ngAnimate. With the use of jQuery
and jQueryUI, the implementation of the same animation will look as follows:</p>
<pre class="highlight javascript"><code><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'ngAnimate'</span><span class="p">]).</span><span class="nx">animation</span><span class="p">(</span><span class="s1">'.effect'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">removeClass</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">className</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">className</span> <span class="o">===</span> <span class="s1">'ng-hide'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,</span> <span class="s1">'blue'</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">).</span><span class="nx">animate</span><span class="p">({</span>
          <span class="na">color</span><span class="p">:</span> <span class="s1">'red'</span>
        <span class="p">},</span> <span class="nx">done</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">done</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<h2>&quot;Follow Us&quot; box</h2>

<p>Now that we know how to use ngAnimate, let&#39;s try employing it to build a directive
that will create us a box. This box will appear when we scroll a webpage down
to the end of an article – exactly the same way as seen on the Shelly Cloud blog.</p>

<p>We begin by writing the markup in HTML:</p>
<pre class="highlight html"><code><span class="nt">&lt;article&gt;</span>
  ...
<span class="nt">&lt;/article&gt;</span>

<span class="nt">&lt;follow-us</span> <span class="na">class=</span><span class="s">"island"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h4&gt;</span>Follow us on Twitter!<span class="nt">&lt;/h4&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://twitter.com/shellycloud"</span> <span class="na">class=</span><span class="s">"twitter-follow-button"</span> <span class="na">data-show-count=</span><span class="s">"true"</span> <span class="na">data-size=</span><span class="s">"large"</span><span class="nt">&gt;</span>Follow @shellycloud<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;script&gt;</span> <span class="c1">// https://dev.twitter.com/docs/follow-button</span>
    <span class="o">!</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">id</span><span class="p">){</span><span class="kd">var</span> <span class="nx">js</span><span class="p">,</span><span class="nx">fjs</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">)){</span><span class="nx">js</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="nx">js</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="nx">id</span><span class="p">;</span><span class="nx">js</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s2">"//platform.twitter.com/widgets.js"</span><span class="p">;</span><span class="nx">fjs</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">js</span><span class="p">,</span><span class="nx">fjs</span><span class="p">);}}(</span><span class="nb">document</span><span class="p">,</span><span class="s2">"script"</span><span class="p">,</span><span class="s2">"twitter-wjs"</span><span class="p">);</span><span class="o">!</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">id</span><span class="p">){</span><span class="kd">var</span> <span class="nx">js</span><span class="p">,</span><span class="nx">fjs</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">)){</span><span class="nx">js</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="nx">js</span><span class="p">.</span><span class="nx">id</span><span class="o">=</span><span class="nx">id</span><span class="p">;</span><span class="nx">js</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s2">"//platform.twitter.com/widgets.js"</span><span class="p">;</span><span class="nx">fjs</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">js</span><span class="p">,</span><span class="nx">fjs</span><span class="p">);}}(</span><span class="nb">document</span><span class="p">,</span><span class="s2">"script"</span><span class="p">,</span><span class="s2">"twitter-wjs"</span><span class="p">);</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/follow-us&gt;</span>
</code></pre>

<p>We create a very simple first version of the <code>followUs</code> directive:</p>
<pre class="highlight javascript"><code><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'ngAnimate'</span><span class="p">])</span>
<span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">'followUs'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">restrict</span><span class="p">:</span> <span class="s1">'E'</span><span class="p">,</span>
    <span class="na">replace</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">transclude</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;div class="follow-us"&gt;'</span> <span class="o">+</span>
                <span class="s1">'&lt;div ng-transclude&gt;&lt;/div&gt;'</span> <span class="o">+</span>
              <span class="s1">'&lt;/div&gt;'</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<p>Since we want the box to be hidden by default and to have a close button,
we update the template with the required elements:</p>
<pre class="highlight javascript"><code><span class="c1">// ...</span>
<span class="nl">template</span><span class="p">:</span> <span class="s1">'&lt;div class="follow-us" ng-show="followUs"&gt;'</span> <span class="o">+</span>
            <span class="s1">'&lt;a href="" ng-click="closeFollowUs()" class="close"&gt;&amp;#x00d7;&lt;/a&gt;'</span> <span class="o">+</span>
            <span class="s1">'&lt;div ng-transclude&gt;&lt;/div&gt;'</span> <span class="o">+</span>
          <span class="s1">'&lt;/div&gt;'</span>
<span class="c1">// ...</span>
</code></pre>

<p>The next thing to do is to implement the box&#39;s behavior. In order to do it
correctly, we need to know the article&#39;s height, the current scroll position,
and have the appropriate event assigned. When the box is closed, we also want to
save this information in the cookies. This will prevent the box from reappearing
when the user visits the webpage again. Everything looks as follows:</p>
<pre class="highlight javascript"><code><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'app'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'ngAnimate'</span><span class="p">])</span>
<span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">'followUs'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">restrict</span><span class="p">:</span> <span class="s1">'E'</span><span class="p">,</span>
    <span class="na">replace</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">transclude</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;div class="follow-us" ng-show="followUs"&gt;'</span> <span class="o">+</span>
                <span class="s1">'&lt;a href="" ng-click="closeFollowUs()" class="close"&gt;&amp;#x00d7;&lt;/a&gt;'</span> <span class="o">+</span>
                <span class="s1">'&lt;div ng-transclude&gt;&lt;/div&gt;'</span> <span class="o">+</span>
              <span class="s1">'&lt;/div&gt;'</span><span class="p">,</span>
    <span class="na">link</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">articleHeight</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'article'</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'article'</span><span class="p">).</span><span class="nx">height</span><span class="p">();</span>

      <span class="kd">var</span> <span class="nx">scrollPosition</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span>
      <span class="p">};</span>

      <span class="kd">var</span> <span class="nx">hasCookie</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'skipFollowUs'</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="nx">scope</span><span class="p">.</span><span class="nx">closeFollowUs</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="s2">"skipFollowUs=1"</span><span class="p">;</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">followUs</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">};</span>

      <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'scroll'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">scrollPosition</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">articleHeight</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">hasCookie</span><span class="p">())</span> <span class="p">{</span>
          <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">scope</span><span class="p">.</span><span class="nx">followUs</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<p>Our last step is adding styles and animations. First, we implement the basic
styles that give the whole thing a proper look:</p>
<pre class="highlight css"><code><span class="nc">.follow-us</span> <span class="p">{</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">fixed</span><span class="p">;</span>
  <span class="nl">bottom</span><span class="p">:</span> <span class="m">3%</span><span class="p">;</span>
  <span class="nl">right</span><span class="p">:</span> <span class="m">3%</span><span class="p">;</span>
  <span class="nl">max-width</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span>
  <span class="nl">z-index</span><span class="p">:</span> <span class="m">10</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.island</span> <span class="p">{</span>
  <span class="nl">background</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">.2</span><span class="p">);</span>
  <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">3px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">.2</span><span class="p">);</span>
<span class="p">}</span>

<span class="nc">.close</span> <span class="p">{</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
  <span class="nl">top</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span>
  <span class="nl">right</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p>All that is left for us is to add two animations. The first one that plays
when the box appears, and the second one when it&#39;s closed. In addition,
we have to ensure that our box will be visible for the entire duration
of the animation. The corresponding CSS looks as follows:</p>
<pre class="highlight css"><code><span class="k">@keyframes</span> <span class="n">falling</span> <span class="p">{</span>
  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">transform</span><span class="p">:</span> <span class="n">rotateZ</span><span class="p">(</span><span class="m">0deg</span><span class="p">);</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">transform</span><span class="p">:</span> <span class="n">translateY</span><span class="p">(</span><span class="m">200px</span><span class="p">)</span> <span class="n">rotateZ</span><span class="p">(</span><span class="m">90deg</span><span class="p">);</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">@-webkit-keyframes</span> <span class="n">falling</span> <span class="p">{</span>
  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">-webkit-transform</span><span class="p">:</span> <span class="n">rotateZ</span><span class="p">(</span><span class="m">0deg</span><span class="p">);</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">-webkit-transform</span><span class="p">:</span> <span class="n">translateY</span><span class="p">(</span><span class="m">200px</span><span class="p">)</span> <span class="n">rotateZ</span><span class="p">(</span><span class="m">90deg</span><span class="p">);</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">@keyframes</span> <span class="n">sliding-from-bottom</span> <span class="p">{</span>
  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">-2%</span><span class="p">;</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">@-webkit-keyframes</span> <span class="n">sliding-from-bottom</span> <span class="p">{</span>
  <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">-2%</span><span class="p">;</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nc">.follow-us.ng-hide-remove</span> <span class="p">{</span>
  <span class="nl">animation</span><span class="p">:</span> <span class="n">sliding-from-bottom</span> <span class="m">300ms</span><span class="p">;</span>
  <span class="nl">-webkit-animation</span><span class="p">:</span> <span class="n">sliding-from-bottom</span> <span class="m">300ms</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.follow-us.ng-hide-add</span> <span class="p">{</span>
  <span class="nl">animation</span><span class="p">:</span> <span class="n">falling</span> <span class="m">800ms</span> <span class="nb">both</span><span class="p">;</span>
  <span class="nl">-webkit-animation</span><span class="p">:</span> <span class="n">falling</span> <span class="m">800ms</span> <span class="nb">both</span><span class="p">;</span>
  <span class="nl">transform-origin</span><span class="p">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
  <span class="nl">-webkit-transform-origin</span><span class="p">:</span> <span class="nb">top</span> <span class="nb">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.follow-us.ng-hide-remove</span><span class="o">,</span> <span class="nc">.follow-us.ng-hide-add</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span> <span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<h2>Summary</h2>

<p>Animations are becoming an increasingly important element of web applications,
and they are sure to play one of the key roles in interface design in 2014.
The ngAnimate library makes working with them much easier, and is a virtually
indispensable component for the current users of AngularJS. This project is worth
watching and keeping up with.</p>

<p>To finish off, a couple of links to some additional materials on this topic:</p>

<ul>
<li><a href="http://code.angularjs.org/1.2.9/docs/api/ngAnimate">Official ngAnimate documentation</a></li>
<li><a href="http://www.ng-newsletter.com/posts/angular-animation.html">Entry in the ng-newsletter dedicated to animations</a></li>
<li><a href="http://www.yearofmoo.com/2013/08/remastered-animation-in-angularjs-1-2.html">Post on the blog of Matias Niemelä – one of the authors of ngAnimate</a></li>
<li><a href="http://www.youtube.com/watch?v=hC0MpgUoui4">Video about ngAnimate from the ng-conf 2014 conference</a></li>
</ul>
<div class="work-with-us"><p>At Ragnarson we help companies deliver great products. We take care of development and deployment so that they can focus on growing the product and working with customers.</p><a class="btn" href="https://ragnarson.com/?utm_source=ragnarson&utm_medium=blog&utm_campaign=work-with-us#contact">Work with us</a></div><div class="article-comments"><div id="commento"></div>
<script src="https://cdn.commento.io/js/commento.js"></script>
</div></div><footer><div class="text--center"><a href="https://ragnarson.com/?utm_source=ragnarson&amp;utm_medium=blog&amp;utm_campaign=blog-footer"><img src="/images/ragnar-desk-c0d025368e.png" srcset="/images/ragnar-desk-c0d025368e.png 1x, /images/ragnar-desk-2x-c0332b062e.png 2x" alt="Ragnar desk" /></a></div></footer></div><script src="/javascripts/application-c0ec307bf9.js"></script></body></html>